# 生产环境上线检查清单

部署到公网前请逐项确认，以符合商业级与合规要求。

---

## 一、安全

- [ ] **SECRET_KEY**（用户注册）：已改为随机长字符串（≥32 字符），且未使用默认值 `change-me-in-production`
- [ ] **ADMIN_API_KEY**（AgentChat 看板）：已设置，仅运维知晓；未设置时看板与 `/api/admin/status` 仍可访问，生产建议必设
- [ ] **OPENAI_API_KEY**：未写入代码或提交到仓库，仅通过环境变量或密钥管理注入
- [ ] **数据库**：生产使用强密码，不使用 `postgres/postgres`；DATABASE_URL 仅服务器可访问
- [ ] **CORS**：已配置 `CORS_ORIGINS` 为实际前端域名列表，未在生产使用 `*`
- [ ] **HTTPS**：对外访问已通过 Nginx / 负载均衡配置 HTTPS，并重定向 HTTP→HTTPS（建议）

---

## 二、运行与依赖

- [ ] **健康检查**：`/health`、`/ready`（若有）可被负载均衡或编排系统访问
- [ ] **PostgreSQL**：数据目录持久化（Docker 卷或 EBS）；已做定期备份（可选脚本或托管备份）
- [ ] **Redis**：若启用，持久化与内存根据流量配置
- [ ] **日志**：应用日志落盘或集中收集，未在日志中记录密码、Token、完整 API Key

---

## 三、限流与稳定性

- [ ] **登录/注册限流**：已配置 `RATE_LIMIT_AUTH_PER_MIN`，防止暴力破解（默认已启用）
- [ ] **聊天限流**：已配置 `RATE_LIMIT_CHAT_PER_MIN`，防止单用户/IP 滥用（默认已启用）
- [ ] **请求体大小**：FastAPI 或反向代理已限制 body 大小，防止超大请求

---

## 四、合规与对外

- [ ] **隐私政策**：已部署或链接到 [docs/PRIVACY.md](./docs/PRIVACY.md) 或贵司正式隐私政策页面
- [ ] **用户协议**：已部署或链接到 [docs/TERMS.md](./docs/TERMS.md) 或贵司正式用户协议页面
- [ ] **注册/登录页**：若自建前端，需在合适位置提供隐私政策与用户协议链接

---

## 五、监控与运维

- [ ] **监控**：对接口可用性、错误率、延迟有监控或告警（如 CloudWatch、自建 Prometheus）
- [ ] **告警**：健康检查失败或 5xx 增多时有通知
- [ ] **部署方式**：使用 Docker Compose 或 K8s 等可复现方式，并记录部署文档（如 DEPLOY_AWS.md）

---

完成以上项后，可将服务对外发布为商业级可用版本；后续可根据审计与合规要求继续补充（如日志保留期限、数据脱敏等）。
